tengo este ciclo: foreach ($result as $row){

$count++;
$pdf->SetFillColor(173, 255, 47); $pdf->Cell(60, 10, '', 0, 0, 'C'); $pdf->SetFont('helvetica', 'B', 10); $pdf->Cell(60, 10, 'Cambio Nro. '.$count, 0, 1, 'C'); $pdf->Cell(30, 10, 'Toner', 1, 0, 'C', true); $pdf->Cell(30, 10, 'Fecha', 1, 0, 'C', true); $pdf->Cell(30, 10, 'Días', 1, 0, 'C', true); $pdf->Cell(20, 10, 'Contador', 1, 0, 'C', true); $pdf->Cell(30, 10, 'Rendimiento', 1, 0, 'C', true); $pdf->Cell(20, 10, 'Promedio', 1, 0, 'C', true); $pdf->Cell(30, 10, 'Costo/pág', 1, 1, 'C', true);

$pdf->SetFont('helvetica', '', 10);

$pdf->Cell(30, 20, $row['toner'].' '.$row['color'], 1, 0, 'C');

$pdf->Cell(30, 10, $row['fecha'], 1, 0, 'C');

$pdf->Cell(30, 20, 'dias', 1, 0, 'C');

$pdf->Cell(20, 10, $row['contador'], 1, 0, 'C');

$pdf->Cell(30, 20, 'rendimiento', 1, 0, 'C');

$pdf->Cell(20, 20, 'promedio', 1, 0, 'C');

$pdf->Cell(30, 20, $row['costo'], 1, 1, 'C'); $pdf->Cell(10, 10, '', 0, 1, 'C');

}

quiero que se cumplan las siguientes condiciones:

si el toner del siguiente registro coincide con el toner de alguno de los ya añadidos, que su celda de fecha y de contador se coloquen debajo de la celda de fecha y contador de el último registro con el que coincida.

con respecto a lo de arriba, quiero que se vayan agrupando de dos en dos, por ejemplo: 1er registro con Toner A junto a 2do registro con Toner A, luego 2do registro de Toner A con 3er registro de Toner A, 1er registro con Toner B junto a 2do registro con Toner B y así sucesivamente.

En la celda día quiero una operación en la que se reste la fecha de el segundo registro con la de el primer registro para obtener la diferencia de días, en la celda rendimiento quiero una operación en la que se reste el valor del contador de el segundo registro con el de el primer registro para obtener la diferencia de rendimiento, en la celda de promedio quiero una operacion que saque el promedio de rendimientos entre el número de registros totales (primero el promedio desde el primer al segundo registro, luego el promedio desde el primer al tercer registro, luego del primero al cuarto y así sucesivamente) y por último en la celda costo que tenga una operación en la que se divida el costo de el cambio_toner entre el valor del rendimiento (rendimiento de el primer y segundo registro, luego del segundo y tercero, tercero y cuarto y así sucesivamente)